(this["webpackJsonpwould-you-rather-reactnd-app"]=this["webpackJsonpwould-you-rather-reactnd-app"]||[]).push([[0],{49:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(38),r=a.n(s),i=(a(49),a(2)),o=a(9),l=a(4),u=a(3),d=a.n(u),j=a(7),b=a(8),m=a.n(b);var p=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],s=a[1],r=Object(n.useState)(),o=Object(i.a)(r,2),l=o[0],u=o[1];return Object(n.useEffect)((function(){e&&function(){var t=Object(j.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.get("/api/userInfo/",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",accept:"application/json"}});case 3:a=t.sent,u(a.data),s(!0),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),alert(t.t0.response.data.msg);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),{isLogged:[c,s],user:[l,u]}},h=a(0),v=Object(n.createContext)(),O=function(e){var t=e.children,a=Object(n.useState)(!1),c=Object(i.a)(a,2),s=c[0],r=c[1];Object(n.useEffect)((function(){if(localStorage.getItem("firstLogin")){var e=function(){var t=Object(j.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.post("/api/token/refresh/",{refresh:localStorage.getItem("refreshtoken")});case 2:a=t.sent,r(a.data.access),setTimeout((function(){e()}),24e4);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e()}}),[]);var o={token:[s,r],userAPI:p(s)};return Object(h.jsx)(v.Provider,{value:o,children:t})};var x=function(e){var t=Object(n.useContext)(v),a=Object(i.a)(t.userAPI.isLogged,1)[0],c=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("firstLogin"),window.location.href="/";case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("nav",{className:"navbar navbar-expand-sm bg-light",children:Object(h.jsxs)("div",{className:"conatiner container-fluid",children:[Object(h.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(h.jsx)("span",{className:"navbar-toggler-icon"})}),Object(h.jsx)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:Object(h.jsxs)("ul",{className:"navbar-nav",children:[Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(o.b,{to:"/",exact:!0,className:"nav-link",activeClassName:"active",children:"Home"})},"Home"),a&&Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(o.b,{to:"/profile",exact:!0,className:"nav-link",activeClassName:"active",children:"Profile"})},"Profile"),a&&Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(o.b,{to:"/conversations",exact:!0,className:"nav-link",activeClassName:"active",children:"Conversations"})},"Conversations"),Object(h.jsx)("li",{className:"nav-item",children:a?Object(h.jsx)(o.b,{to:"/",onClick:c,className:"nav-link",children:"logout"}):Object(h.jsx)(o.b,{to:"/login",exact:!0,className:"nav-link",activeClassName:"active",children:"login"})},"login"),a?"":Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(o.b,{to:"/register",exact:!0,className:"nav-link",children:"register"})},"Registeration")]})})]})})},f=a(40),N=a(41),g=a(42),w=a(17),y=a(44),k=a(43),C=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(N.a)(this,a),(n=t.call(this,e)).state={toHome:!1,username:"",password:"",error:""},n.handleChange=n.handleChange.bind(Object(w.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(w.a)(n)),n}return Object(g.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(f.a)({},e.target.name,e.target.value))}},{key:"login",value:function(){var e=Object(j.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("/api/token/",{username:this.state.username,password:this.state.password},{headers:{"Content-Type":"application/json",accept:"application/json"}});case 3:t=e.sent,a=t.data.refresh,localStorage.setItem("refreshtoken",a),localStorage.setItem("firstLogin",!0),window.location.href="/",e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert(e.t0.response.data.detail);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){e.preventDefault(),this.login()}},{key:"render",value:function(){return this.state.toHome?Object(h.jsx)(l.a,{to:"/"}):Object(h.jsx)("div",{className:"box_list_container",children:Object(h.jsxs)("form",{className:"box_content",onSubmit:this.handleSubmit,children:[Object(h.jsx)("h3",{children:this.state.error}),Object(h.jsx)("div",{className:"box_content_item login",children:Object(h.jsx)("input",{name:"username",placeholder:"Username",onChange:this.handleChange,value:this.state.username,required:!0})}),Object(h.jsx)("div",{className:"box_content_item login",children:Object(h.jsx)("input",{name:"password",placeholder:"Password",onChange:this.handleChange,value:this.state.password,type:"password",required:!0})}),Object(h.jsx)("div",{className:"box_content_item btn_container login",children:Object(h.jsx)("button",{onClick:this.handleSubmit,className:"btn",children:"Sign in"})})]})})}}]),a}(n.Component),S=a(20);var I=function(e){var t=Object(n.useContext)(v),a=Object(i.a)(t.userAPI.user,1)[0];return Object(h.jsx)("div",{className:"card",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)(o.b,{to:"/conversations/".concat(e.conversation.id),className:"nav_link",activeClassName:"active",children:Object(h.jsx)("h5",{className:"card-title",children:e.conversation.title})}),Object(h.jsx)("p",{className:"card-text",children:Object(h.jsx)("small",{className:"text-muted",children:a.username})}),Object(h.jsx)("p",{className:"card-text",children:Object(h.jsx)("small",{className:"text-muted",children:e.conversation.created})})]})})};var _=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],s=Object(n.useContext)(v),r=Object(i.a)(s.token,1)[0],o=Object(n.useState)(""),l=Object(i.a)(o,2),u=l[0],b=l[1],p=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("/api/chat/conversations/",{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json",accept:"application/json"}});case 3:t=e.sent,c(t.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){p()}),[r]);var O=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/chat/conversations/",{title:u},{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json",accept:"application/json"}});case 2:t=e.sent,b(""),c([].concat(Object(S.a)(a),[t.data]));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"box_list_container",children:[Object(h.jsxs)("div",{className:"input-group mb-3",children:[Object(h.jsx)("input",{type:"text",value:u,onChange:function(e){return b(e.target.value)},className:"form-control",placeholder:"Enter the problem title","aria-label":"Example text with button addon","aria-describedby":"button-addon1"}),Object(h.jsx)("button",{className:"btn btn-primary",type:"button",id:"button-addon1",onClick:function(e){e.preventDefault(),O()},children:"Add Ticket"})]}),a.map((function(e){return Object(h.jsx)("li",{children:Object(h.jsx)(I,{conversation:e})},e.id)}))]})};a.p;var P=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(!0),a=Object(i.a)(t,2),c=(a[0],a[1]),s=Object(n.useState)(!0),r=Object(i.a)(s,2),o=r[0],u=r[1],b=Object(n.useState)([]),p=Object(i.a)(b,2),O=p[0],x=p[1],f=Object(n.useState)(""),N=Object(i.a)(f,2),g=N[0],w=N[1],y=Object(n.useContext)(v),k=Object(i.a)(y.token,1)[0],C=Object(i.a)(y.userAPI.user,1)[0],I=Object(l.f)(),_=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("api/chat/conversations/".concat(I.id,"/"),{headers:{Authorization:"Bearer ".concat(k),"Content-Type":"application/json",accept:"application/json"}});case 3:t=e.sent,x(t.data),c(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Not authorized"),window.location.href="/";case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===g){e.next=15;break}return u(!1),w(""),e.prev=3,x([].concat(Object(S.a)(O),[{body:g,user:C.username,id:100968}])),e.next=7,m.a.post("api/chat/conversations/".concat(I.id,"/"),{body:g},{headers:{Authorization:"Bearer ".concat(k),"Content-Type":"application/json",accept:"application/json"}});case 7:e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),alert("Message wasn't sent");case 13:u(!0),_();case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){_()}),[]),Object(n.useEffect)((function(){var t;null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}),[O]),Object(h.jsx)("div",{className:"container py-5 px-4",children:Object(h.jsxs)("div",{className:"row rounded-lg overflow-hidden shadow",children:[Object(h.jsxs)("div",{className:"px-4 py-5 chat-box bg-white",children:[O.map((function(e){return e.user===C.username?Object(h.jsx)("div",{className:"media w-50 ms-auto mb-3",children:Object(h.jsxs)("div",{className:"media-body",children:[Object(h.jsx)("div",{className:"bg-primary rounded py-2 px-3 mb-2",children:Object(h.jsx)("p",{className:"text-small mb-0 text-white",children:e.body})}),Object(h.jsx)("p",{className:"small text-muted",children:e.created})]})},e.id):Object(h.jsx)("div",{className:"media w-50 mb-3",children:Object(h.jsxs)("div",{className:"media-body me-auto",children:[Object(h.jsx)("div",{className:"bg-secondary rounded py-2 px-3 mb-2",children:Object(h.jsx)("p",{className:"text-small mb-0 text-white",children:e.body})}),Object(h.jsx)("p",{className:"small text-muted",children:e.created})]})},e.id)})),Object(h.jsx)("div",{ref:e})]}),Object(h.jsx)("form",{action:"#",className:"bg-light",onSubmit:function(e){e.preventDefault(),P()},children:Object(h.jsxs)("div",{className:"input-group mb-3",children:[Object(h.jsx)("input",{value:g,onChange:function(e){return w(e.target.value)},type:"text",placeholder:"Type a message","aria-describedby":"button-addon2",className:"form-control"}),Object(h.jsx)("button",{id:"button-addon2",type:"submit",className:"r-2 btn btn-outline-primary",disabled:!o,children:Object(h.jsx)("i",{className:"fa fa-paper-plane"})})]})})]})})};var A=function(){var e=Object(n.useContext)(v),t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=(a[0],a[1],Object(i.a)(e.userAPI.user,1)[0]);return Object(h.jsxs)("div",{className:"container",children:[Object(h.jsxs)("h2",{children:["Username: ",c.username]}),Object(h.jsxs)("h2",{children:["Name: ",c.first_name," ",c.last_name]}),Object(h.jsxs)("h2",{children:["Role: ",1===c.role?"Customer":"Admin"]})]})},T=a.p+"static/media/0e5ce481-c452-4513-9263-eee5ef87de8d.d50ff660.jfif";var E=function(){return Object(h.jsx)("div",{className:"container text-center",children:Object(h.jsx)("img",{className:"img-fluid",src:T,alt:"logo"})})};var F=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),r=Object(i.a)(s,2),o=r[0],l=r[1],u=Object(n.useState)(""),b=Object(i.a)(u,2),p=b[0],v=b[1],O=Object(n.useState)(""),x=Object(i.a)(O,2),f=x[0],N=x[1],g=Object(n.useState)(),w=Object(i.a)(g,2),y=w[0],k=(w[1],Object(n.useState)("")),C=Object(i.a)(k,2),S=C[0],I=C[1],_=Object(n.useState)(""),P=Object(i.a)(_,2),A=P[0],T=P[1],E=Object(n.useState)(!1),F=Object(i.a)(E,2),L=F[0],q=F[1],B=Object(n.useState)({}),z=Object(i.a)(B,2),U=z[0],D=z[1],H=function(){var e=Object(j.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("/api/token/",{username:a,password:o},{headers:{"Content-Type":"application/json",accept:"application/json"}});case 3:t=e.sent,n=t.data.refresh,localStorage.setItem("refreshtoken",n),localStorage.setItem("firstLogin",!0),window.location.href="/",e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert(e.t0.response.data.detail);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.prev=1,e.next=4,m.a.post("/api/accounts/register/",{username:a,email:f,first_name:S,last_name:A,password:o,password_confirm:p,dateOfBirth:y},{headers:{"Content-Type":"application/json",accept:"application/json"}});case 4:e.sent,H(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.response.data),D(e.t0.response.data);case 12:q(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("form",{children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputEmail",className:"form-label",children:"Email address"}),Object(h.jsx)("input",{required:!0,onChange:function(e){return N(e.target.value)},type:"email",className:"form-control ".concat(U.email?"is-invalid":""),id:"InputEmail",value:f}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.email})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputUsername",className:"form-label",children:"Username"}),Object(h.jsx)("input",{required:!0,onChange:function(e){return c(e.target.value)},type:"text",className:"form-control ".concat(U.username?"is-invalid":""),id:"InputUsername",value:a}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.username})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputFirstName",className:"form-label",children:"First Name"}),Object(h.jsx)("input",{required:!0,onChange:function(e){return I(e.target.value)},type:"text",className:"form-control ".concat(U.first_name?"is-invalid":""),id:"InputFirstName",value:S}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.first_name})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputLastName",className:"form-label",children:"Last Name"}),Object(h.jsx)("input",{required:!0,onChange:function(e){return T(e.target.value)},type:"text",className:"form-control ".concat(U.last_name?"is-invalid":""),id:"InputLastName",value:A}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.last_name})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputPass1",className:"form-label",children:"Password"}),Object(h.jsx)("input",{required:!0,type:"password",onChange:function(e){return l(e.target.value)},className:"form-control ".concat(U.password?"is-invalid":""),id:"InputPass1",value:o}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.password})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"InputPass2",className:"form-label",children:"Password Confirmation"}),Object(h.jsx)("input",{required:!0,type:"password",onChange:function(e){return v(e.target.value)},className:"form-control ".concat(U.password_confirm?"is-invalid":""),id:"InputPass2",value:p}),Object(h.jsx)("div",{className:"invalid-feedback",children:U.password_confirm})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){e.preventDefault(),R()},disabled:L,children:"Submit"})]})})};var L=function(){var e=Object(n.useContext)(v),t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],s=(a[1],Object(i.a)(e.userAPI.isLogged,1)[0]);return Object(h.jsx)(o.a,{children:Object(h.jsx)("div",{className:"App",children:Object(h.jsxs)(n.Fragment,{children:[Object(h.jsx)(x,{}),!0===c?null:Object(h.jsxs)(n.Fragment,{children:[Object(h.jsx)(l.b,{path:"/",exact:!0,component:E}),Object(h.jsx)(l.b,{path:"/profile",exact:!0,component:s?A:C}),Object(h.jsx)(l.b,{path:"/conversations",exact:!0,component:s?_:C}),Object(h.jsx)(l.b,{path:"/conversations/:id",children:s?Object(h.jsx)(P,{}):Object(h.jsx)(C,{})}),Object(h.jsx)(l.b,{path:"/login",exact:!0,component:C}),Object(h.jsx)(l.b,{path:"/register",exact:!0,component:F})]})]})})})};a(79);r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsxs)(O,{children:[Object(h.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"}),Object(h.jsx)(L,{})]})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.5083e7f7.chunk.js.map